# AI Services API

REST API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º–∏: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∏ —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üé® –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:
  - **Playground v2.5** (Hugging Face) ‚Äî –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
  - **Flux Klein** ‚Äî –±—ã—Å—Ç—Ä—ã–π –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π
  - **Qwen** ‚Äî –ø–æ–Ω–∏–º–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω—ã
  - **Leonardo.AI** (GPT-1.5, Seedream-4.5, Gemini-2.5-flash)
  - **Pixazo** ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
  - **Radames** ‚Äî –±—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑–º–µ—Ä—ã (256-2048 px)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π blacklist –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (24 —á–∞—Å–∞)

### üé§ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ (Speech-to-Text)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤: WAV, MP3, OGG, OGA
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏ –Ω–∞—Ä–µ–∑–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Google Speech Recognition
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤

### üîä –°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ (Text-to-Speech)
- Microsoft Edge TTS ‚Äî –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤ (ru-RU-DmitryNeural, ru-RU-SvetlanaNeural –∏ –¥—Ä.)
- –ë—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è MP3

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Python 3.12**
- **FastAPI** ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Uvicorn** ‚Äî ASGI —Å–µ—Ä–≤–µ—Ä
- **edge-tts** ‚Äî —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏ Microsoft Edge
- **SpeechRecognition** ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ Google
- **gradio_client** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å Hugging Face Spaces
- **pydub** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ
- **Docker** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
python-api/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ image_router.py # –†–æ—É—Ç–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ speech_router.py# –†–æ—É—Ç–µ—Ä TTS/STT
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ speech.py           # –õ–æ–≥–∏–∫–∞ TTS/STT
‚îÇ       ‚îî‚îÄ‚îÄ image/
‚îÇ           ‚îú‚îÄ‚îÄ __init__.py
‚îÇ           ‚îú‚îÄ‚îÄ base.py         # –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
‚îÇ           ‚îú‚îÄ‚îÄ orchestrator.py # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
‚îÇ           ‚îú‚îÄ‚îÄ playground.py   # Hugging Face Playground
‚îÇ           ‚îú‚îÄ‚îÄ flux_klein.py   # Flux Klein
‚îÇ           ‚îú‚îÄ‚îÄ qwen.py         # Qwen
‚îÇ           ‚îú‚îÄ‚îÄ leonardo.py     # Leonardo.AI
‚îÇ           ‚îú‚îÄ‚îÄ pixazo.py       # Pixazo
‚îÇ           ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ .env
```

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone <repository-url>
cd python-api
```

2. –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏ venv\Scripts\activate –¥–ª—è Windows
pip install -r requirements.txt
```

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
API_KEY=your-api-key-here

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è Hugging Face
HF_TOKEN=your-huggingface-token

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è Leonardo.AI
LEONARDO_API_KEY=your-leonardo-api-key
LEONARDO_MODEL_ID=gpt-image-1.5
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### Docker

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t ai-services-api .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8000:8000 --env-file .env ai-services-api
```

## üìñ API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- Swagger UI: `http://localhost:8000/docs`
- ReDoc: `http://localhost:8000/redoc`

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```
POST /api/image/generate
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| prompt | string | ‚úÖ | –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º |
| negative_prompt | string | ‚ùå | –ß–µ–≥–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ |
| width | int | ‚ùå | –®–∏—Ä–∏–Ω–∞ (256-2048, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1024) |
| height | int | ‚ùå | –í—ã—Å–æ—Ç–∞ (256-2048, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 680) |

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
| –ó–∞–≥–æ–ª–æ–≤–æ–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|----------|
| x-token | API –∫–ª—é—á –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST "http://localhost:8000/api/image/generate?prompt=A%20beautiful%20sunset%20over%20mountains&width=1024&height=680" \
  -H "x-token: your-api-key" \
  --output generated_image.png
```

#### –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏

```
POST /api/speech-to-text
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| file | file | ‚úÖ | –ê—É–¥–∏–æ—Ñ–∞–π–ª (WAV, MP3, OGG) |

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST "http://localhost:8000/api/speech-to-text" \
  -H "x-token: your-api-key" \
  -F "file=@audio.mp3"
```

#### –°–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏

```
POST /api/text-to-speech
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| text | string | ‚úÖ | –¢–µ–∫—Å—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏ |
| voice | string | ‚ùå | –ì–æ–ª–æ—Å (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ru-RU-DmitryNeural) |
| filename | string | ‚ùå | –ò–º—è —Ñ–∞–π–ª–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é audio.mp3) |

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```bash
curl -X POST "http://localhost:8000/api/text-to-speech?text=–ü—Ä–∏–≤–µ—Ç%20–º–∏—Ä&voice=ru-RU-DmitryNeural" \
  -H "x-token: your-api-key" \
  --output speech.mp3
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ–ª–æ—Å–∞:**
- `ru-RU-DmitryNeural` ‚Äî –º—É–∂—Å–∫–æ–π —Ä—É—Å—Å–∫–∏–π
- `ru-RU-SvetlanaNeural` ‚Äî –∂–µ–Ω—Å–∫–∏–π —Ä—É—Å—Å–∫–∏–π
- `en-US-GuyNeural` ‚Äî –º—É–∂—Å–∫–æ–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
- `en-US-JennyNeural` ‚Äî –∂–µ–Ω—Å–∫–∏–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
- –∏ –¥—Ä—É–≥–∏–µ...

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `x-token`:

```bash
curl -H "x-token: your-api-key" ...
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `logs/providers.log`:
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø—Ä–æ—Å–∞—Ö
- –°—Ç–∞—Ç—É—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –û—à–∏–±–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- Blacklist —Å–æ–±—ã—Ç–∏—è

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (`git checkout -b feature/amazing-feature`)
3. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [Hugging Face](https://huggingface.co/) ‚Äî –∑–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ Spaces –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [Leonardo.AI](https://leonardo.ai/) ‚Äî –∑–∞ API –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [Microsoft Edge TTS](https://github.com/rany2/edge-tts) ‚Äî –∑–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏
- [Google Speech Recognition](https://cloud.google.com/speech-to-text) ‚Äî –∑–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏
